<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>signup</title>
    <link rel="stylesheet" href="/css/signup_student.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/4.2.0/mustache.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
<!--
<form action="/user/signupsave" method="post" oninput="return validateForm()">

    {{#duplication}}
        <div class="alert alert-danger" role="alert">
            이미 존재하는 ID 입니다.
        </div>
    {{/duplication}}
    <div class="mb-3">
        <label for="ID 입력" class="form-label">회원 ID</label>
        <input type="text" class="form-control" id="LoginId" name="loginId" maxlength='30' required>
        <div id="idError" class="text-danger" style="display: none;">아이디는 6-12자의 영문, 숫자, 기호(-, _)만 사용 가능합니다.</div>
    </div>
    <div class="mb-3">
        <label for="비번입력" class="form-label">비밀번호</label>
        <input type="password" class="form-control" id="password" name="password" maxlength='30' required>
        <div id="passwordError" class="text-danger" style="display: none;">비밀번호는 6-15자의 영문, 숫자, 특수문자가 하나 이상 필요합니다.(숫자로 시작 불가)</div>
    </div>
    <div class="mb-3">
        <label for="이름입력" class="form-label">이름</label>
        <input type="text" class="form-control" id="name" name="name" maxlength='30' required>
        <div id="nameError" class="text-danger" style="display: none;">이름은 한글 또는 영어로만 입력 가능합니다.</div>
    </div>
    <div class="mb-3">
        <label for="전화번호" class="form-label">전화번호</label>
        <input type="text" class="form-control" id="phoneNumber" name="phoneNumber" maxlength='13' required>
        <div id="phoneError" class="text-danger" style="display: none;">전화번호는 숫자와 (-) 만 입력 가능합니다.</div>
    </div>
    {{#not_exist_teacherCode}}
        <div class="alert alert-danger" role="alert">
            존재하지 않는 교사 코드입니다.
        </div>
    {{/not_exist_teacherCode}}
    <div class="mb-3">
        <label for="교사코드" class="form-label">교사 코드</label>
        <input type="text" class="form-control" id="teacherCode" name="teacherCode" maxlength='13' required>
    </div>


    <input type="hidden" id="role" name="role" value="student">


    <button type="submit" class="btn btn-primary">회원가입</button>
    <a target="_blank" href="/user/login" id="signup" class="find_text">로그인</a>
</form>

-->
<div class="_003">
    <form action="/user/signupsave" method="post" oninput="return validateForm()">
        <div class="full">
            <div class="div">개인정보 수집 및 이용 동의서</div>
            <div class="div02">에듀스마일 서비스 이용약관 </div>
            <div class="div2">

            </div>
            {{#duplication}}
                <div class="duplication-danger" role="alert" style="color: #ff0000;">
                    이미 존재하는 ID 입니다.
                </div>
            {{/duplication}}
            <div class="id">
                ID<input type="text" class="form-control-id" id="LoginId" name="loginId" maxlength='30' required>

                <div id="idError" class="text-danger" style="font-size: 1vw; display: none;">아이디는 6-12자의 영문, 숫자, 기호(-, _)만 사용 가능합니다.</div>
            </div>

            <div class="div3">
                비밀번호<input type="password" class="form-control-pw" id="password" name="password" maxlength='30' required>
                <div id="passwordError" class="text-danger" style="font-size: 1vw; display: none;">비밀번호는 6-15자의 영문, 숫자, 특수문자가 하나 이상 필요합니다.</div>
            </div>

            <div class="div4">
                비밀번호 확인<input type="password" class="form-control-pwcheck" id="samepassword" name="samepassword" maxlength='30' required>
                <div id="SamepasswordError" class="text-danger" style="font-size: 1vw; display: none;">비밀번호가 일치 하지 않습니다</div>
            </div>


            <div class="div8">
                이름<input type="text" class="form-control-name" id="name" name="name" maxlength='30' required>
                <div id="nameError" class="text-danger" style="font-size: 1vw;  display: none;">이름은 한글 또는 영어로만 입력 가능합니다.</div>
            </div>
            <div class="div9">
                전화 번호<input type="tel" class="form-control-pnumber" id="phoneNumber" name="phoneNumber" maxlength='11' required>
                <div id="phoneError" class="text-danger" style="font-size: 1vw; display: none;">전화번호는 숫자만 입력 가능합니다.</div>
            </div>
            {{#not_exist_teacherCode}}
                <div class="teacnercode-danger" role="alert">
                    존재하지 않는 학급코드입니다.
                </div>
            {{/not_exist_teacherCode}}
            <div class="t-code">
                학급코드<input type="text" class="form-control-tcode" id="teacherCode" name="teacherCode" maxlength='5' placeholder="5자리" required>
            </div>

            <div class="frame-12">
                <img class="_3" src="/images/_30.png" />
                <div class="div12">학생 회원가입</div>
            </div>
            <div class="rectangle-1062">개인정보 수집 및 이용 동의서 (학생용)<br><br>
                에듀스마일(이하 "플랫폼 제공자")는 서비스 제공 및 회원 관리를 위해 아래와 같이 개인정보를 수집·이용합니다. 내용을 충분히 읽고 동의 여부를 선택해 주시기 바랍니다.<br><br>

                수집하는 개인정보 항목<br><br>

                필수 항목:
                ID, 비밀번호, 이름, 전화번호, 학급코드<br><br>
                선택 항목:
                추가 학습 계획 데이터, 기타 서비스 제공에 필요한 추가 정보 (예: 학습 목표)<br><br>
                개인정보 수집 및 이용 목적<br><br>

                회원 관리:
                회원가입, 본인 인증, 회원 자격 유지 및 관리<br><br>
                서비스 제공:
                학습 자료 제공, 복습 및 학습 계획 지원, 상담 기록 확인 등<br><br>
                서비스 개선:
                서비스 품질 향상을 위한 통계 분석 및 연구<br><br>
                개인정보 보유 및 이용 기간<br><br>

                개인정보는 원칙적으로 회원 탈퇴 후 관련 법령에 따라 보존이 필요한 정보를 제외하고 즉시 파기됩니다.<br><br>
                법령에 따라 보존이 필요한 경우:
                계약 및 청약철회 기록: 5년
                소비자 불만 및 분쟁 처리 기록: 3년<br><br>
                개인정보 제공 및 공유<br><br>

                플랫폼 제공자는 사용자의 개인정보를 외부에 제공하지 않습니다.
                단, 법령에 따라 요구되거나 사용자가 사전에 동의한 경우에 한해 개인정보를 제3자에게 제공할 수 있습니다.<br><br>
                개인정보의 위탁<br><br>

                플랫폼 제공자는 서비스 운영을 위해 개인정보 처리 업무를 외부 업체에 위탁할 수 있습니다.
                위탁 업무의 내용 및 수탁자는 개인정보처리방침을 통해 공개합니다.<br><br>
                동의 거부 권리 및 불이익

                사용자는 개인정보 제공 및 이용에 대한 동의를 거부할 권리가 있습니다.
                단, 필수 항목에 대한 동의를 거부할 경우 서비스 이용이 제한될 수 있습니다.</div>

            <div class="rectangle-1063">에듀스마일 서비스 이용약관<br><br>

                제1조 (목적)<br><br>
                이 약관은 에듀스마일(이하 "플랫폼 제공자")이 제공하는 에듀스마일 서비스(이하 "서비스")의 이용과 관련하여 플랫폼 제공자와 사용자 간의 권리, 의무, 책임 및 기타 필요한 사항을 규정함을 목적으로 합니다.
                <br><br>
                제2조 (정의)<br><br>
                "서비스"란 플랫폼 제공자가 제공하는 교사와 학생을 위한 AI 기반의 업무 보조 및 학습 관리 서비스를 의미합니다. <br><br>
                "사용자"란 본 약관에 따라 서비스를 이용하는 회원 및 비회원을 의미합니다.<br><br>
                "회원"이란 플랫폼 제공자의 서비스에 회원가입하여 지속적으로 서비스를 이용할 수 있는 자를 의미합니다.<br><br>
                "비회원"이란 회원가입 없이 플랫폼 제공자가 제공하는 일부 서비스를 이용하는 자를 의미합니다.
                <br><br>
                제3조 (약관의 효력 및 변경)<br><br>
                본 약관은 서비스를 이용하려는 모든 사용자에게 효력을 발생합니다.<br><br>
                플랫폼 제공자는 관련 법령을 위반하지 않는 범위 내에서 본 약관을 변경할 수 있으며, 변경된 약관은 서비스 내 공지하거나 사용자에게 개별 통지합니다.<br><br>
                사용자가 변경된 약관에 동의하지 않을 경우 서비스 이용을 중단하고 회원탈퇴를 요청할 수 있습니다.<br><br>

                제4조 (회원가입 및 관리)<br><br>
                회원가입은 사용자가 약관에 동의하고, 플랫폼 제공자가 정한 가입 양식을 작성한 후 이를 승인함으로써 성립됩니다.<br><br>
                사용자는 정확한 정보를 제공해야 하며, 부정확한 정보를 제공하여 발생한 문제에 대한 책임은 사용자 본인에게 있습니다.<br><br>
                회원은 언제든지 서비스 내 설정 메뉴를 통해 회원탈퇴를 요청할 수 있으며, 플랫폼 제공자는 이를 신속히 처리합니다.
                <br><br>
                제5조 (서비스 이용)<br><br>
                플랫폼 제공자는 다음과 같은 서비스를 제공합니다<br><br>

                상담 기록 관리 ,
                생기부 작성 보조 및 분석 ,
                수업 자료 자동 생성 및 관리 ,
                기타 AI 기반의 업무 보조 서비스<br><br>
                플랫폼 제공자는 기술적 문제, 시스템 점검, 유지보수 또는 기타 운영상의 필요가 있는 경우 서비스 제공을 일시적으로 중단할 수 있습니다. 이 경우, 사전에 공지하거나 긴급 상황 시 사후에 통지합니다.
                <br><br>
                제6조 (사용자의 의무)<br><br>
                사용자는 관련 법령, 본 약관의 규정, 서비스 이용 안내 및 공지사항 등을 준수해야 합니다.<br><br>
                사용자는 다음 행위를 해서는 안 됩니다:
                허위 정보를 등록하거나 타인의 정보를 도용하는 행위 ,
                서비스 운영을 방해하거나 정상적인 이용을 저해하는 행위 ,
                플랫폼 제공자 및 타인의 지식재산권을 침해하는 행위<br><br>
                위반 사항이 발견될 경우 플랫폼 제공자는 해당 사용자의 서비스 이용을 제한하거나 회원자격을 박탈할 수 있습니다.
                <br><br>
                제7조 (플랫폼 제공자의 의무)<br><br>
                플랫폼 제공자는 관련 법령 및 본 약관을 준수하며, 안정적으로 서비스를 제공하기 위해 최선을 다합니다.<br><br>
                플랫폼 제공자는 사용자로부터 제기된 의견이나 불만 사항을 신속히 처리하며, 처리가 지연될 경우 사용자에게 사유와 처리 일정을 안내합니다.<br><br>
                플랫폼 제공자는 사용자의 개인정보를 안전하게 보호하며, 개인정보처리방침에 따라 관리합니다.<br><br>

                제8조 (서비스 중단 및 이용 제한)<br><br>
                플랫폼 제공자는 다음과 같은 사유가 발생한 경우 서비스의 전부 또는 일부를 중단할 수 있습니다:
                시스템 점검, 유지보수 또는 교체 ,
                정전, 천재지변, 기타 불가항력 ,
                기타 서비스 운영상 중대한 사유 <br><br>
                플랫폼 제공자의 귀책으로 인해 서비스가 장기간 중단될 경우, 플랫폼 제공자는 사용자에게 손해를 보상하기 위해 노력합니다.<br><br>

                제9조 (개인정보 보호)<br><br>
                플랫폼 제공자는 사용자의 개인정보를 보호하기 위해 개인정보처리방침을 수립·공개하며, 관련 법령을 준수합니다.<br><br>
                사용자의 개인정보는 서비스 제공 및 이용 목적 범위 내에서만 사용됩니다.<br><br>

                제10조 (지식재산권)<br><br>
                플랫폼 제공자가 작성한 콘텐츠와 서비스 내 제공되는 모든 자료에 대한 저작권 및 지식재산권은 플랫폼 제공자에게 귀속됩니다.<br><br>
                사용자는 플랫폼 제공자의 명시적인 동의 없이 이를 복제, 배포, 수정하거나 상업적으로 이용할 수 없습니다.<br><br>

                제11조 (책임 제한)<br><br>
                플랫폼 제공자는 사용자가 서비스를 이용하며 발생한 손해에 대해 책임을 지지 않습니다. 단, 플랫폼 제공자의 고의 또는 중과실로 인한 손해는 제외합니다.<br><br>
                플랫폼 제공자는 사용자 간 또는 사용자와 제3자 간에 발생한 분쟁에 개입하지 않으며, 이로 인한 손해에 대해 책임을 지지 않습니다.
                <br><br>
                제12조 (준거법 및 재판 관할)
                본 약관은 대한민국 법령에 따라 규정되고 이행됩니다.
                서비스 이용 중 발생한 분쟁에 대해 소송이 제기될 경우, 플랫폼 제공자의 본사 소재지를 관할하는 법원을 관할 법원으로 합니다.</div></div>
            <input type="hidden" id="role" name="role" value="student">


        <button type="submit" id="submitButton" class="signup-btn" disabled>회원가입</button>
        <div class="agree-check"><input type="checkbox" id="checkbox1"> 위 내용에 동의합니다.</div><div class="agree-check2"><input type="checkbox" id="checkbox2"> 위 내용에 동의합니다.</div>
    </form>
    <div class="tcode-text" id="tcode-response"></div>
    <button type="button" id="backtologin-btn" class="back-btn">
        <a target="_self" id="btlogin" class="btlogin"  href="/user/login"><< 로그인으로 돌아가기</a>
    </button>
    <button type="button" id="tcode-btn" onclick="sendtcode()" class="tcode-btn">등록하기</button>
    <img class="line-31" src="/images/line-31.svg" />
    <div class="main-box"></div>
    <div class="line1"></div>

</div>


<script>


    let isTcodeClicked = false; // tcode-btn이 클릭되었는지 여부를 저장하는 플래그

    async function sendtcode() { // 학급코드 유효성 찾기
        const tcode_input = document.getElementById("teacherCode");

        const tcode = tcode_input.value.trim(); // 공백 제거

        // 입력값이 비어있을 경우
        if (!tcode) {
            document.getElementById("tcode-response").textContent = "학급코드를 입력하세요.";
            return; // 함수 종료
        }

        try {
            const response = await fetch("/user/tcode", {
                method: "POST",
                headers: {
                    "Content-Type": "text/plain",
                },
                body: tcode
            });

            if (response.ok) {
                const data = await response.text(); // 서버에서 문자열 응답 받기
                document.getElementById("tcode-response").textContent = `${data}`;

                if (data === "등록 실패") {
                    document.getElementById("submitButton").disabled = true; // 제출 버튼 비활성화
                    isTcodeClicked = false; // 실패 시 플래그를 false로 유지
                    return false;
                } else {
                    isTcodeClicked = true; // 성공 시 플래그 true로 설정
                    validateForm(); // 입력값 다시 확인
                }
            } else {
                document.getElementById("tcode-response").textContent = "Error: Failed to send data.";
            }
        } catch (error) {
            console.error("Error:", error);
            document.getElementById("tcode-response").textContent = "Error: Unable to connect to the server.";
        }
    }


    function validateForm() { // 회원가입 입력값 유효성 검사
        let isValid = true;

        // 아이디 유효성 검사
        const id = document.getElementById("LoginId").value;
        const idregex = /^(?![0-9]{6,12}$)[a-zA-Z0-9-_]{6,14}$/;
        const iderrorMessage = document.getElementById("idError");

        if (!idregex.test(id)) {
            iderrorMessage.style.display = "block";
            isValid = false;
        } else {
            iderrorMessage.style.display = "none";
        }

        // 비밀번호 유효성 검사
        const password = document.getElementById("password").value;
        const passwordregex = /^(?!\d)(?=[a-zA-Z0-9~․!@#$%^&*()_\-+=\[\]{}|\\;:'"<>,.?/]*[~․!@#$%^&*()_\-+=\[\]{}|\\;:'"<>,.?/])[a-zA-Z0-9~․!@#$%^&*()_\-+=\[\]{}|\\;:'"<>,.?/]{6,15}$/;
        const passworderrorMessage = document.getElementById("passwordError");

        if (!passwordregex.test(password)) {
            passworderrorMessage.style.display = "block";
            isValid = false;
        } else {
            passworderrorMessage.style.display = "none";
        }

        // 비밀번호 확인
        const samepassword = document.getElementById("samepassword").value;
        const SamepassworderrorMessage = document.getElementById("SamepasswordError");

        if (password !== samepassword) {
            SamepassworderrorMessage.style.display = "block";
            isValid = false;
        } else {
            SamepassworderrorMessage.style.display = "none";
        }

        // 이름 유효성 검사
        const name = document.getElementById("name").value;
        const nameregex = /^[a-zA-Z]+$|^[가-힣]+$/;
        const nameerrorMessage = document.getElementById("nameError");

        if (!nameregex.test(name)) {
            nameerrorMessage.style.display = "block";
            isValid = false;
        } else {
            nameerrorMessage.style.display = "none";
        }

        // 전화번호 유효성 검사
        const phone = document.getElementById("phoneNumber").value;
        const phoneregex = /^\d*$/;
        const phoneerrorMessage = document.getElementById("phoneError");

        if (!phoneregex.test(phone)) {
            phoneerrorMessage.style.display = "block";
            isValid = false;
        } else {
            phoneerrorMessage.style.display = "none";
        }

        // 학급코드 확인
        const tcode_response = document.getElementById("tcode-response").textContent;

        if (tcode_response === "" || !isTcodeClicked) {
            isValid = false;
        }
        const checkbox1 = document.getElementById("checkbox1");
        const checkbox2 = document.getElementById("checkbox2");
        //  체크박스 확인
        if (!checkbox1.checked || !checkbox2.checked) {
            isValid = false;
        }

        // 모든 조건을 통과해야 제출 버튼 활성화
        document.getElementById("submitButton").disabled = !isValid;
        return isValid;
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>